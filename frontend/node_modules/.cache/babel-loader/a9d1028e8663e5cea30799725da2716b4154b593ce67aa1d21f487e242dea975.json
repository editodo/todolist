{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"notice-write\"\n};\nconst _hoisted_2 = {\n  class: \"write-container\"\n};\nconst _hoisted_3 = {\n  class: \"editor-container\"\n};\nconst _hoisted_4 = {\n  class: \"file-upload\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_checkbox = _resolveComponent(\"el-checkbox\");\n  const _component_QuillEditor = _resolveComponent(\"QuillEditor\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_upload = _resolveComponent(\"el-upload\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n    class: \"header\"\n  }, [_createElementVNode(\"h1\", null, \"공지사항 작성\")], -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_form, {\n    model: $setup.noticeForm,\n    rules: $setup.rules,\n    ref: \"noticeFormRef\",\n    \"label-width\": \"80px\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_form_item, {\n      label: \"제목\",\n      prop: \"title\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $setup.noticeForm.title,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.noticeForm.title = $event),\n        placeholder: \"제목을 입력하세요\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"공지사항\",\n      prop: \"isNotice\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_checkbox, {\n        modelValue: $setup.noticeForm.isNotice,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.noticeForm.isNotice = $event)\n      }, {\n        default: _withCtx(() => [...(_cache[3] || (_cache[3] = [_createTextVNode(\" 공지사항으로 등록 \", -1 /* CACHED */)]))]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"내용\",\n      prop: \"content\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_QuillEditor, {\n        content: $setup.noticeForm.content,\n        \"onUpdate:content\": _cache[2] || (_cache[2] = $event => $setup.noticeForm.content = $event),\n        contentType: \"html\",\n        theme: \"snow\",\n        options: $setup.editorOptions,\n        onReady: $setup.onEditorReady\n      }, null, 8 /* PROPS */, [\"content\", \"options\", \"onReady\"])])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"첨부파일\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_upload, {\n        ref: \"uploadRef\",\n        \"auto-upload\": false,\n        \"on-change\": $setup.handleFileChange,\n        \"on-remove\": $setup.handleFileRemove,\n        \"file-list\": $setup.fileList,\n        multiple: \"\",\n        limit: 5\n      }, {\n        tip: _withCtx(() => [...(_cache[5] || (_cache[5] = [_createElementVNode(\"div\", {\n          class: \"el-upload__tip\"\n        }, \" 최대 5개 파일, 각 파일 10MB 이하 \", -1 /* CACHED */)]))]),\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          icon: $setup.Upload\n        }, {\n          default: _withCtx(() => [...(_cache[4] || (_cache[4] = [_createTextVNode(\" 파일 선택 \", -1 /* CACHED */)]))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"icon\"])]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"on-change\", \"on-remove\", \"file-list\"])])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, null, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: $setup.submitNotice,\n        loading: $setup.loading\n      }, {\n        default: _withCtx(() => [...(_cache[6] || (_cache[6] = [_createTextVNode(\" 등록 \", -1 /* CACHED */)]))]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\", \"loading\"]), _createVNode(_component_el_button, {\n        onClick: $setup.goBack\n      }, {\n        default: _withCtx(() => [...(_cache[7] || (_cache[7] = [_createTextVNode(\"취소\", -1 /* CACHED */)]))]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\", \"rules\"])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_form","model","$setup","noticeForm","rules","ref","_component_el_form_item","label","prop","_component_el_input","title","$event","placeholder","_component_el_checkbox","isNotice","_cache","_hoisted_3","_component_QuillEditor","content","contentType","theme","options","editorOptions","onReady","onEditorReady","_hoisted_4","_component_el_upload","handleFileChange","handleFileRemove","fileList","multiple","limit","tip","_withCtx","_component_el_button","type","icon","Upload","onClick","submitNotice","loading","goBack"],"sources":["D:\\03.기타\\todolist\\frontend\\src\\views\\NoticeWrite.vue"],"sourcesContent":["<template>\r\n  <div class=\"notice-write\">\r\n    <div class=\"header\">\r\n      <h1>공지사항 작성</h1>\r\n    </div>\r\n\r\n    <div class=\"write-container\">\r\n      <el-form :model=\"noticeForm\" :rules=\"rules\" ref=\"noticeFormRef\" label-width=\"80px\">\r\n        <el-form-item label=\"제목\" prop=\"title\">\r\n          <el-input v-model=\"noticeForm.title\" placeholder=\"제목을 입력하세요\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"공지사항\" prop=\"isNotice\">\r\n          <el-checkbox v-model=\"noticeForm.isNotice\">\r\n            공지사항으로 등록\r\n          </el-checkbox>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"내용\" prop=\"content\">\r\n          <div class=\"editor-container\">\r\n            <QuillEditor\r\n              v-model:content=\"noticeForm.content\"\r\n              contentType=\"html\"\r\n              theme=\"snow\"\r\n              :options=\"editorOptions\"\r\n              @ready=\"onEditorReady\"\r\n            />\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"첨부파일\">\r\n          <div class=\"file-upload\">\r\n            <el-upload\r\n              ref=\"uploadRef\"\r\n              :auto-upload=\"false\"\r\n              :on-change=\"handleFileChange\"\r\n              :on-remove=\"handleFileRemove\"\r\n              :file-list=\"fileList\"\r\n              multiple\r\n              :limit=\"5\"\r\n            >\r\n              <el-button type=\"primary\" :icon=\"Upload\">\r\n                파일 선택\r\n              </el-button>\r\n              <template #tip>\r\n                <div class=\"el-upload__tip\">\r\n                  최대 5개 파일, 각 파일 10MB 이하\r\n                </div>\r\n              </template>\r\n            </el-upload>\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitNotice\" :loading=\"loading\">\r\n            등록\r\n          </el-button>\r\n          <el-button @click=\"goBack\">취소</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Upload } from '@element-plus/icons-vue'\r\nimport { QuillEditor } from '@vueup/vue-quill'\r\nimport '@vueup/vue-quill/dist/vue-quill.snow.css'\r\n\r\nexport default {\r\n  name: 'NoticeWrite',\r\n  components: {\r\n    QuillEditor\r\n  },\r\n  setup() {\r\n    const store = useStore()\r\n    const router = useRouter()\r\n    const noticeFormRef = ref()\r\n    const uploadRef = ref()\r\n    const loading = ref(false)\r\n    const fileList = ref([])\r\n    const uploadedFiles = ref([])\r\n\r\n    const noticeForm = reactive({\r\n      title: '',\r\n      content: '',\r\n      isNotice: false,\r\n      attachments: []\r\n    })\r\n\r\n    const rules = {\r\n      title: [\r\n        { required: true, message: '제목을 입력해주세요', trigger: 'blur' },\r\n        { min: 2, max: 200, message: '제목은 2-200자 사이여야 합니다', trigger: 'blur' }\r\n      ],\r\n      content: [\r\n        { required: true, message: '내용을 입력해주세요', trigger: 'blur' }\r\n      ]\r\n    }\r\n\r\n    const editorOptions = {\r\n      modules: {\r\n        toolbar: [\r\n          ['bold', 'italic', 'underline', 'strike'],\r\n          ['blockquote', 'code-block'],\r\n          [{ 'header': 1 }, { 'header': 2 }],\r\n          [{ 'list': 'ordered'}, { 'list': 'bullet' }],\r\n          [{ 'script': 'sub'}, { 'script': 'super' }],\r\n          [{ 'indent': '-1'}, { 'indent': '+1' }],\r\n          [{ 'direction': 'rtl' }],\r\n          [{ 'size': ['small', false, 'large', 'huge'] }],\r\n          [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\r\n          [{ 'color': [] }, { 'background': [] }],\r\n          [{ 'font': [] }],\r\n          [{ 'align': [] }],\r\n          ['clean'],\r\n          ['link', 'image']\r\n        ]\r\n      },\r\n      placeholder: '내용을 입력하세요...'\r\n    }\r\n\r\n    const user = computed(() => store.state.auth.user)\r\n    const canWrite = computed(() => {\r\n      return user.value && (user.value.isAdmin || user.value.hasNoticePermission)\r\n    })\r\n\r\n    const onEditorReady = (quill) => {\r\n      console.log('Editor is ready!', quill)\r\n    }\r\n\r\n    const handleFileChange = (file) => {\r\n      console.log('File changed:', file)\r\n    }\r\n\r\n    const handleFileRemove = (file) => {\r\n      console.log('File removed:', file)\r\n      const index = uploadedFiles.value.findIndex(f => f.originalFilename === file.name)\r\n      if (index > -1) {\r\n        uploadedFiles.value.splice(index, 1)\r\n      }\r\n    }\r\n\r\n    const uploadFiles = async () => {\r\n      const files = fileList.value.map(item => item.raw).filter(Boolean)\r\n      const uploaded = []\r\n\r\n      for (const file of files) {\r\n        try {\r\n          const result = await store.dispatch('notice/uploadFile', file)\r\n          uploaded.push(result)\r\n        } catch (error) {\r\n          ElMessage.error(`파일 업로드 실패: ${file.name}`)\r\n          throw error\r\n        }\r\n      }\r\n\r\n      return uploaded\r\n    }\r\n\r\n    const submitNotice = async () => {\r\n      if (!canWrite.value) {\r\n        ElMessage.error('게시글 작성 권한이 없습니다.')\r\n        return\r\n      }\r\n\r\n      try {\r\n        await noticeFormRef.value.validate()\r\n        \r\n        loading.value = true\r\n\r\n        // 파일 업로드\r\n        const attachments = await uploadFiles()\r\n        noticeForm.attachments = attachments\r\n\r\n        // 공지사항 등록\r\n        await store.dispatch('notice/createNotice', noticeForm)\r\n        \r\n        ElMessage.success('공지사항이 등록되었습니다.')\r\n        router.push('/notices')\r\n      } catch (error) {\r\n        console.error('공지사항 등록 실패:', error)\r\n        ElMessage.error('공지사항 등록에 실패했습니다.')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n\r\n    const goBack = () => {\r\n      router.back()\r\n    }\r\n\r\n    onMounted(() => {\r\n      if (!canWrite.value) {\r\n        ElMessage.error('게시글 작성 권한이 없습니다.')\r\n        router.push('/notices')\r\n      }\r\n    })\r\n\r\n    return {\r\n      noticeFormRef,\r\n      uploadRef,\r\n      loading,\r\n      fileList,\r\n      noticeForm,\r\n      rules,\r\n      editorOptions,\r\n      canWrite,\r\n      onEditorReady,\r\n      handleFileChange,\r\n      handleFileRemove,\r\n      submitNotice,\r\n      goBack,\r\n      Upload\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.notice-write {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n\r\n.header {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.header h1 {\r\n  margin: 0;\r\n  font-size: 2rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.write-container {\r\n  background: var(--el-bg-color);\r\n  border-radius: 8px;\r\n  padding: 30px;\r\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.editor-container {\r\n  border: 1px solid var(--el-border-color);\r\n  border-radius: 4px;\r\n}\r\n\r\n.editor-container :deep(.ql-editor) {\r\n  min-height: 300px;\r\n}\r\n\r\n.file-upload {\r\n  width: 100%;\r\n}\r\n\r\n.el-upload__tip {\r\n  color: var(--el-text-color-secondary);\r\n  font-size: 0.9rem;\r\n  margin-top: 8px;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .notice-write {\r\n    padding: 15px;\r\n  }\r\n  \r\n  .write-container {\r\n    padding: 20px;\r\n  }\r\n  \r\n  .header h1 {\r\n    font-size: 1.5rem;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}